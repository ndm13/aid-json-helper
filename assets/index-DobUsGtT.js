var Tl=Object.defineProperty;var El=(t,e,l)=>e in t?Tl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[e]=l;var rt=(t,e,l)=>(El(t,typeof e!="symbol"?e+"":e,l),l);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function l(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=l(s);fetch(s.href,o)}})();function he(){}function Il(t,e){for(const l in e)t[l]=e[l];return t}function fl(t){return t()}function At(){return Object.create(null)}function ge(t){t.forEach(fl)}function dt(t){return typeof t=="function"}function Oe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Nl(t){return Object.keys(t).length===0}function ht(t,...e){if(t==null){for(const n of e)n(void 0);return he}const l=t.subscribe(...e);return l.unsubscribe?()=>l.unsubscribe():l}function we(t){let e;return ht(t,l=>e=l)(),e}function ye(t,e,l){t.$$.on_destroy.push(ht(e,l))}function Sl(t,e,l,n){if(t){const s=dl(t,e,l,n);return t[0](s)}}function dl(t,e,l,n){return t[1]&&n?Il(l.ctx.slice(),t[1](n(e))):l.ctx}function Al(t,e,l,n){if(t[2]&&n){const s=t[2](n(l));if(e.dirty===void 0)return s;if(typeof s=="object"){const o=[],i=Math.max(e.dirty.length,s.length);for(let a=0;a<i;a+=1)o[a]=e.dirty[a]|s[a];return o}return e.dirty|s}return e.dirty}function Ol(t,e,l,n,s,o){if(s){const i=dl(e,l,n,o);t.p(i,s)}}function Rl(t){if(t.ctx.length>32){const e=[],l=t.ctx.length/32;for(let n=0;n<l;n++)e[n]=-1;return e}return-1}function Se(t,e,l){return t.set(l),e}function r(t,e){t.appendChild(e)}function b(t,e,l){t.insertBefore(e,l||null)}function y(t){t.parentNode&&t.parentNode.removeChild(t)}function Ie(t,e){for(let l=0;l<t.length;l+=1)t[l]&&t[l].d(e)}function f(t){return document.createElement(t)}function Y(t){return document.createTextNode(t)}function g(){return Y(" ")}function He(){return Y("")}function A(t,e,l,n){return t.addEventListener(e,l,n),()=>t.removeEventListener(e,l,n)}function d(t,e,l){l==null?t.removeAttribute(e):t.getAttribute(e)!==l&&t.setAttribute(e,l)}function $l(t){let e;return{p(...l){e=l,e.forEach(n=>t.push(n))},r(){e.forEach(l=>t.splice(t.indexOf(l),1))}}}function hl(t){return t===""?null:+t}function Ll(t){return Array.from(t.childNodes)}function x(t,e){e=""+e,t.data!==e&&(t.data=e)}function fe(t,e){t.value=e??""}function Ot(t,e){for(let l=0;l<t.options.length;l+=1){const n=t.options[l];n.selected=~e.indexOf(n.__value)}}function Dl(t){return[].map.call(t.querySelectorAll(":checked"),e=>e.__value)}function ne(t,e,l){t.classList.toggle(e,!!l)}function Fl(t,e,{bubbles:l=!1,cancelable:n=!1}={}){return new CustomEvent(t,{detail:e,bubbles:l,cancelable:n})}let We;function je(t){We=t}function zl(){if(!We)throw new Error("Function called outside component initialization");return We}function pl(){const t=zl();return(e,l,{cancelable:n=!1}={})=>{const s=t.$$.callbacks[e];if(s){const o=Fl(e,l,{cancelable:n});return s.slice().forEach(i=>{i.call(t,o)}),!o.defaultPrevented}return!0}}const De=[],Rt=[];let Fe=[];const $t=[],Yl=Promise.resolve();let ct=!1;function Hl(){ct||(ct=!0,Yl.then(gl))}function ze(t){Fe.push(t)}const at=new Set;let $e=0;function gl(){if($e!==0)return;const t=We;do{try{for(;$e<De.length;){const e=De[$e];$e++,je(e),Ml(e.$$)}}catch(e){throw De.length=0,$e=0,e}for(je(null),De.length=0,$e=0;Rt.length;)Rt.pop()();for(let e=0;e<Fe.length;e+=1){const l=Fe[e];at.has(l)||(at.add(l),l())}Fe.length=0}while(De.length);for(;$t.length;)$t.pop()();ct=!1,at.clear(),je(t)}function Ml(t){if(t.fragment!==null){t.update(),ge(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ze)}}function Pl(t){const e=[],l=[];Fe.forEach(n=>t.indexOf(n)===-1?e.push(n):l.push(n)),l.forEach(n=>n()),Fe=e}const et=new Set;let Ae;function Ce(){Ae={r:0,c:[],p:Ae}}function Te(){Ae.r||ge(Ae.c),Ae=Ae.p}function P(t,e){t&&t.i&&(et.delete(t),t.i(e))}function Z(t,e,l,n){if(t&&t.o){if(et.has(t))return;et.add(t),Ae.c.push(()=>{et.delete(t),n&&(l&&t.d(1),n())}),t.o(e)}else n&&n()}function pe(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function ve(t){t&&t.c()}function be(t,e,l){const{fragment:n,after_update:s}=t.$$;n&&n.m(e,l),ze(()=>{const o=t.$$.on_mount.map(fl).filter(dt);t.$$.on_destroy?t.$$.on_destroy.push(...o):ge(o),t.$$.on_mount=[]}),s.forEach(ze)}function ke(t,e){const l=t.$$;l.fragment!==null&&(Pl(l.after_update),ge(l.on_destroy),l.fragment&&l.fragment.d(e),l.on_destroy=l.fragment=null,l.ctx=[])}function jl(t,e){t.$$.dirty[0]===-1&&(De.push(t),Hl(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Me(t,e,l,n,s,o,i=null,a=[-1]){const c=We;je(t);const u=t.$$={fragment:null,ctx:[],props:o,update:he,not_equal:s,bound:At(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:At(),dirty:a,skip_bound:!1,root:e.target||c.$$.root};i&&i(u.root);let h=!1;if(u.ctx=l?l(t,e.props||{},(p,m,...w)=>{const _=w.length?w[0]:m;return u.ctx&&s(u.ctx[p],u.ctx[p]=_)&&(!u.skip_bound&&u.bound[p]&&u.bound[p](_),h&&jl(t,p)),m}):[],u.update(),h=!0,ge(u.before_update),u.fragment=n?n(u.ctx):!1,e.target){if(e.hydrate){const p=Ll(e.target);u.fragment&&u.fragment.l(p),p.forEach(y)}else u.fragment&&u.fragment.c();e.intro&&P(t.$$.fragment),be(t,e.target,e.anchor),gl()}je(c)}class Pe{constructor(){rt(this,"$$");rt(this,"$$set")}$destroy(){ke(this,1),this.$destroy=he}$on(e,l){if(!dt(l))return he;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(l),()=>{const s=n.indexOf(l);s!==-1&&n.splice(s,1)}}$set(e){this.$$set&&!Nl(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Jl="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Jl);function Lt(t,e,l){const n=t.slice();return n[7]=e[l],n}function Dt(t){let e,l=t[7]+"",n,s,o;function i(){return t[6](t[7])}return{c(){e=f("button"),n=Y(l)},m(a,c){b(a,e,c),r(e,n),s||(o=A(e,"click",i),s=!0)},p(a,c){t=a,c&2&&l!==(l=t[7]+"")&&x(n,l)},d(a){a&&y(e),s=!1,o()}}}function Wl(t){let e,l,n,s,o,i,a,c,u,h,p,m,w;const _=t[4].default,v=Sl(_,t,t[3],null);let T=pe(t[1]),E=[];for(let N=0;N<T.length;N+=1)E[N]=Dt(Lt(t,T,N));return{c(){e=f("main"),l=f("header"),n=f("h3"),s=Y(t[0]),o=g(),i=f("button"),i.textContent="ðŸ—™",a=g(),c=f("section"),v&&v.c(),u=g(),h=f("footer");for(let N=0;N<E.length;N+=1)E[N].c();d(n,"class","svelte-1t4g3ms"),d(l,"class","svelte-1t4g3ms"),d(c,"class","svelte-1t4g3ms"),d(h,"class","svelte-1t4g3ms"),d(e,"class","svelte-1t4g3ms")},m(N,$){b(N,e,$),r(e,l),r(l,n),r(n,s),r(l,o),r(l,i),r(e,a),r(e,c),v&&v.m(c,null),r(e,u),r(e,h);for(let I=0;I<E.length;I+=1)E[I]&&E[I].m(h,null);p=!0,m||(w=A(i,"click",t[5]),m=!0)},p(N,[$]){if((!p||$&1)&&x(s,N[0]),v&&v.p&&(!p||$&8)&&Ol(v,_,N,N[3],p?Al(_,N[3],$,null):Rl(N[3]),null),$&6){T=pe(N[1]);let I;for(I=0;I<T.length;I+=1){const F=Lt(N,T,I);E[I]?E[I].p(F,$):(E[I]=Dt(F),E[I].c(),E[I].m(h,null))}for(;I<E.length;I+=1)E[I].d(1);E.length=T.length}},i(N){p||(P(v,N),p=!0)},o(N){Z(v,N),p=!1},d(N){N&&y(e),v&&v.d(N),Ie(E,N),m=!1,w()}}}function Bl(t,e,l){let{$$slots:n={},$$scope:s}=e;const o=pl();let{title:i}=e,{options:a=[]}=e;const c=()=>o("close"),u=h=>o("option"+h.replace(" ",""));return t.$$set=h=>{"title"in h&&l(0,i=h.title),"options"in h&&l(1,a=h.options),"$$scope"in h&&l(3,s=h.$$scope)},[i,a,o,s,n,c,u]}class Re extends Pe{constructor(e){super(),Me(this,e,Bl,Wl,Oe,{title:0,options:1})}}class Gl{constructor(e){this.card=e}copyJson(){navigator.clipboard.writeText(JSON.stringify(this.card,null,4))}copyMarkdown(){const e=`## ${this.card.title}

${this.card.value}

**Tags:** ${this.card.keys}`;navigator.clipboard.writeText(e)}}const Le=[];function ql(t,e){return{subscribe:lt(t,e).subscribe}}function lt(t,e=he){let l;const n=new Set;function s(a){if(Oe(t,a)&&(t=a,l)){const c=!Le.length;for(const u of n)u[1](),Le.push(u,t);if(c){for(let u=0;u<Le.length;u+=2)Le[u][0](Le[u+1]);Le.length=0}}}function o(a){s(a(t))}function i(a,c=he){const u=[a,c];return n.add(u),n.size===1&&(l=e(s,o)||he),a(t),()=>{n.delete(u),n.size===0&&l&&(l(),l=null)}}return{set:s,update:o,subscribe:i}}function Je(t,e,l){const n=!Array.isArray(t),s=n?[t]:t;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const o=e.length<2;return ql(l,(i,a)=>{let c=!1;const u=[];let h=0,p=he;const m=()=>{if(h)return;p();const _=e(n?u[0]:u,i,a);o?i(_):p=dt(_)?_:he},w=s.map((_,v)=>ht(_,T=>{u[v]=T,h&=~(1<<v),c&&m()},()=>{h|=1<<v}));return c=!0,m(),function(){ge(w),p(),c=!1}})}function Ul(t){const{subscribe:e,set:l,update:n}=lt(t());return{subscribe:e,set:l,update:n,reset:()=>l(t())}}var Ee=(t=>(t[t.ALPHA=0]="ALPHA",t[t.TYPE=1]="TYPE",t[t.LENGTH=2]="LENGTH",t[t.NONE=3]="NONE",t))(Ee||{});const ml=/^\s*$/gm;function _l(t){return t.keys.length>0&&bl(t).filter(e=>ml.test(e)).length>0}function Ft(t){return t.keys.trimEnd().endsWith(",")}function Vl(t,e){return e.find(l=>l!=t&&t.type===l.type&&t.keys===l.keys)!==void 0}function Kl(t){return t.useForCharacterCreation===!0&&/^(\s*|Notes go here.)$/g.test(t.description)}function Xl(t,e){return pt(t.title,e)}function Zl(t,e){return pt(t.value,e)}function Ql(t,e){return bl(t).filter(l=>pt(l,e)).length>0}function xl(t,e,l){return yl(t,e.title,l.title)?1:-1}function en(t,e,l){return yl(t,e.type,l.type)?1:-1}function tn(t,e,l){return t?e.value.length-l.value.length:l.value.length-e.value.length}function pt(t,e){return t.toLowerCase().indexOf(e.toLowerCase())>-1}function yl(t,e,l){return t?e.toLowerCase()>l.toLowerCase():l.toLowerCase()>e.toLowerCase()}function bl(t){return t.keys.split(",")}const Ye=lt(localStorage.getItem("autosave")!==null);function ln(){if(we(Ye)){const t=localStorage.getItem("cards");if(t)return JSON.parse(t)}return[]}function nn(){if(we(Ye)){const t=localStorage.getItem("filters");if(t)return JSON.parse(t)}return structuredClone({title:"",value:"",key:"",types:we(kl),missing:!1,noEntryText:!1,duplicateImport:!1,emptyTriggers:!1,noDescription:!1,sort:{mode:Ee.NONE,asc:!0}})}const ce=lt(ln()),kl=Je(ce,t=>[...new Set(t.map(e=>e.type))]),Q=Ul(nn);let vl=()=>{};Ye.subscribe(t=>{if(t){if(localStorage.getItem("autosave")){const n=localStorage.getItem("cards");n&&ce.update(s=>JSON.parse(n))}else localStorage.setItem("autosave","true"),localStorage.setItem("cards",JSON.stringify(we(ce))),localStorage.setItem("filters",JSON.stringify(we(Q)));const e=ce.subscribe(n=>localStorage.setItem("cards",JSON.stringify(n))),l=Q.subscribe(n=>localStorage.setItem("filters",JSON.stringify(n)));vl=()=>{e(),l()}}});Ye.subscribe(t=>{t||(localStorage.clear(),vl())});const tt=Je([ce,Q],([t,e])=>{const l=t.filter(n=>e.types.indexOf(n.type)>-1&&Xl(n,e.title)&&Zl(n,e.value)&&Ql(n,e.key)&&(!e.missing&&!e.noEntryText&&!e.emptyTriggers&&!e.noDescription&&!e.duplicateImport||e.missing&&n.keys.length===0||e.noEntryText&&n.value.length===0||e.duplicateImport&&Vl(n,t)||e.emptyTriggers&&_l(n)||e.noDescription&&Kl(n)));return e.sort.mode===Ee.NONE?l:l.sort((n,s)=>{switch(e.sort.mode){case Ee.ALPHA:return xl(e.sort.asc,n,s);case Ee.TYPE:return en(e.sort.asc,n,s);case Ee.LENGTH:return tn(e.sort.asc,n,s);default:return console.error("Invalid sort mode:",e.sort.mode),0}})});function zt(t,e,l){const n=t.slice();return n[35]=e[l],n}function sn(t){let e,l,n,s,o,i,a,c,u,h=t[5]?"â†™":"â†—",p,m,w;return{c(){e=f("button"),l=Y("âœ¨"),s=g(),o=f("h3"),o.textContent="Placeholder Title",i=g(),a=f("span"),a.textContent="Placeholder Type",c=g(),u=f("button"),p=Y(h),d(e,"title",n="Use for Character Creator [currently "+t[0].useForCharacterCreation+"]"),d(e,"class","svelte-1a1r5xx"),ne(e,"is_cc",t[0].useForCharacterCreation),d(o,"contenteditable","true"),d(o,"class","title svelte-1a1r5xx"),t[0].title===void 0&&ze(()=>t[18].call(o)),d(a,"contenteditable","true"),d(a,"class","type svelte-1a1r5xx"),t[0].type===void 0&&ze(()=>t[20].call(a))},m(_,v){b(_,e,v),r(e,l),b(_,s,v),b(_,o,v),t[0].title!==void 0&&(o.innerText=t[0].title),b(_,i,v),b(_,a,v),t[0].type!==void 0&&(a.innerText=t[0].type),b(_,c,v),b(_,u,v),r(u,p),m||(w=[A(e,"click",t[17]),A(o,"input",t[18]),A(o,"focusout",t[19]),A(a,"input",t[20]),A(a,"focusout",t[21]),A(u,"click",t[22])],m=!0)},p(_,v){v[0]&1&&n!==(n="Use for Character Creator [currently "+_[0].useForCharacterCreation+"]")&&d(e,"title",n),v[0]&1&&ne(e,"is_cc",_[0].useForCharacterCreation),v[0]&1&&_[0].title!==o.innerText&&(o.innerText=_[0].title),v[0]&1&&_[0].type!==a.innerText&&(a.innerText=_[0].type),v[0]&32&&h!==(h=_[5]?"â†™":"â†—")&&x(p,h)},d(_){_&&(y(e),y(s),y(o),y(i),y(a),y(c),y(u)),m=!1,ge(w)}}}function on(t){let e,l,n,s,o,i,a,c,u,h,p,m,w;return{c(){e=f("span"),l=f("input"),s=g(),o=f("button"),o.textContent="Reorder",i=g(),a=f("button"),a.textContent="Delete",c=g(),u=f("button"),u.textContent="Copy JSON",h=g(),p=f("button"),p.textContent="Copy Markdown",d(l,"type","number"),d(l,"min","1"),d(l,"max",n=t[8].length+1),d(l,"class","svelte-1a1r5xx"),d(o,"class","svelte-1a1r5xx"),d(e,"class","reorder svelte-1a1r5xx")},m(_,v){b(_,e,v),r(e,l),fe(l,t[1]),r(e,s),r(e,o),b(_,i,v),b(_,a,v),b(_,c,v),b(_,u,v),b(_,h,v),b(_,p,v),m||(w=[A(l,"input",t[12]),A(l,"keyup",t[13]),A(o,"click",t[10]),A(a,"click",t[14]),A(u,"click",t[15]),A(p,"click",t[16])],m=!0)},p(_,v){v[0]&256&&n!==(n=_[8].length+1)&&d(l,"max",n),v[0]&2&&hl(l.value)!==_[1]&&fe(l,_[1])},d(_){_&&(y(e),y(i),y(a),y(c),y(u),y(h),y(p)),m=!1,ge(w)}}}function rn(t){let e,l=pe(t[0].keys.split(",")),n=[];for(let s=0;s<l.length;s+=1)n[s]=Yt(zt(t,l,s));return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=He()},m(s,o){for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(s,o);b(s,e,o)},p(s,o){if(o[0]&1){l=pe(s[0].keys.split(","));let i;for(i=0;i<l.length;i+=1){const a=zt(s,l,i);n[i]?n[i].p(a,o):(n[i]=Yt(a),n[i].c(),n[i].m(e.parentNode,e))}for(;i<n.length;i+=1)n[i].d(1);n.length=l.length}},d(s){s&&y(e),Ie(n,s)}}}function an(t){let e;return{c(){e=f("em"),e.textContent="No Triggers!"},m(l,n){b(l,e,n)},p:he,d(l){l&&y(e)}}}function cn(t){let e,l,n;return{c(){e=f("input"),d(e,"type","text"),d(e,"class","svelte-1a1r5xx")},m(s,o){b(s,e,o),fe(e,t[0].keys),l||(n=[A(e,"input",t[25]),A(e,"focusout",t[26])],l=!0)},p(s,o){o[0]&1&&e.value!==s[0].keys&&fe(e,s[0].keys)},d(s){s&&y(e),l=!1,ge(n)}}}function Yt(t){let e,l=t[35]+"",n;return{c(){e=f("kbd"),n=Y(l),d(e,"class","svelte-1a1r5xx")},m(s,o){b(s,e,o),r(e,n)},p(s,o){o[0]&1&&l!==(l=s[35]+"")&&x(n,l)},d(s){s&&y(e)}}}function Ht(t){let e,l,n,s=t[0].description.length+"",o,i,a=t[0].description.length===1?"":"s",c,u,h;return{c(){e=f("textarea"),l=g(),n=f("small"),o=Y(s),i=Y(" character"),c=Y(a),d(e,"class","description svelte-1a1r5xx")},m(p,m){b(p,e,m),fe(e,t[0].description),b(p,l,m),b(p,n,m),r(n,o),r(n,i),r(n,c),u||(h=[A(e,"input",t[29]),A(e,"focusout",t[30])],u=!0)},p(p,m){m[0]&1&&fe(e,p[0].description),m[0]&1&&s!==(s=p[0].description.length+"")&&x(o,s),m[0]&1&&a!==(a=p[0].description.length===1?"":"s")&&x(c,a)},d(p){p&&(y(e),y(l),y(n)),u=!1,ge(h)}}}function Mt(t){let e,l;return e=new Re({props:{title:"Delete card '"+t[0].title+"'?",options:["Yes","No"],$$slots:{default:[un]},$$scope:{ctx:t}}}),e.$on("optionYes",t[31]),e.$on("optionNo",t[32]),e.$on("close",t[33]),{c(){ve(e.$$.fragment)},m(n,s){be(e,n,s),l=!0},p(n,s){const o={};s[0]&1&&(o.title="Delete card '"+n[0].title+"'?"),s[1]&128&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){l||(P(e.$$.fragment,n),l=!0)},o(n){Z(e.$$.fragment,n),l=!1},d(n){ke(e,n)}}}function un(t){let e;return{c(){e=f("p"),e.textContent="Are you sure you want to delete this card?"},m(l,n){b(l,e,n)},p:he,d(l){l&&y(e)}}}function fn(t){let e,l,n,s,o,i,a,c,u=t[0].value.length+"",h,p,m=t[0].value.length===1?"":"s",w,_,v,T,E,N,$,I=t[3]?"âœ”":"âœŽ",F,j,O,k=t[4]?"Hide":"Show",R,C,L,S,M,H,ee,ie;function se(z,q){return z[2]?on:sn}let de=se(t),U=de(t);function re(z,q){return z[3]?cn:z[0].keys.length===0?an:rn}let oe=re(t),V=oe(t),K=t[4]&&Ht(t),X=t[6]&&Mt(t);return{c(){e=f("section"),l=f("header"),n=f("button"),n.textContent="â‹¯",s=g(),U.c(),o=g(),i=f("textarea"),a=g(),c=f("small"),h=Y(u),p=Y(" character"),w=Y(m),_=g(),v=f("div"),T=f("h4"),T.textContent="Triggers:",E=g(),V.c(),N=g(),$=f("button"),F=Y(I),j=g(),O=f("button"),R=Y(k),C=Y(`
            Description`),L=g(),K&&K.c(),S=g(),X&&X.c(),M=He(),d(n,"title","Toggle actions"),d(l,"class","svelte-1a1r5xx"),ne(l,"actionMenu",t[2]),d(i,"class","value svelte-1a1r5xx"),d(T,"class","svelte-1a1r5xx"),d($,"class","svelte-1a1r5xx"),d(O,"class","svelte-1a1r5xx"),d(v,"class","triggers svelte-1a1r5xx"),d(e,"class","svelte-1a1r5xx"),ne(e,"fullScreen",t[5])},m(z,q){b(z,e,q),r(e,l),r(l,n),r(l,s),U.m(l,null),r(e,o),r(e,i),fe(i,t[0].value),r(e,a),r(e,c),r(c,h),r(c,p),r(c,w),r(e,_),r(e,v),r(v,T),r(v,E),V.m(v,null),r(v,N),r(v,$),r($,F),r(v,j),r(v,O),r(O,R),r(O,C),r(e,L),K&&K.m(e,null),b(z,S,q),X&&X.m(z,q),b(z,M,q),H=!0,ee||(ie=[A(n,"click",t[11]),A(i,"input",t[23]),A(i,"focusout",t[24]),A($,"click",t[27]),A(O,"click",t[28])],ee=!0)},p(z,q){de===(de=se(z))&&U?U.p(z,q):(U.d(1),U=de(z),U&&(U.c(),U.m(l,null))),(!H||q[0]&4)&&ne(l,"actionMenu",z[2]),q[0]&1&&fe(i,z[0].value),(!H||q[0]&1)&&u!==(u=z[0].value.length+"")&&x(h,u),(!H||q[0]&1)&&m!==(m=z[0].value.length===1?"":"s")&&x(w,m),oe===(oe=re(z))&&V?V.p(z,q):(V.d(1),V=oe(z),V&&(V.c(),V.m(v,N))),(!H||q[0]&8)&&I!==(I=z[3]?"âœ”":"âœŽ")&&x(F,I),(!H||q[0]&16)&&k!==(k=z[4]?"Hide":"Show")&&x(R,k),z[4]?K?K.p(z,q):(K=Ht(z),K.c(),K.m(e,null)):K&&(K.d(1),K=null),(!H||q[0]&32)&&ne(e,"fullScreen",z[5]),z[6]?X?(X.p(z,q),q[0]&64&&P(X,1)):(X=Mt(z),X.c(),P(X,1),X.m(M.parentNode,M)):X&&(Ce(),Z(X,1,1,()=>{X=null}),Te())},i(z){H||(P(X),H=!0)},o(z){Z(X),H=!1},d(z){z&&(y(e),y(S),y(M)),U.d(),V.d(),K&&K.d(),X&&X.d(z),ee=!1,ge(ie)}}}function dn(t,e,l){let n,s;ye(t,ce,V=>l(8,s=V));const o=pl();let{card:i}=e,a=s.findIndex(V=>V===i)+1,c=a,u=!1,h=!1,p=!1,m=!1,w=!1;function _(){c>s.length&&l(1,c=s.length),c<1&&l(1,c=0),c!==a&&(o("reorder",{old:a-1,current:c-1}),l(1,c=a),l(2,u=!u))}const v=()=>l(2,u=!u);function T(){c=hl(this.value),l(1,c)}const E=V=>{V.key==="Enter"&&_()},N=()=>{l(6,w=!0),l(2,u=!u)},$=()=>{n.copyJson(),l(2,u=!u)},I=()=>{n.copyMarkdown(),l(2,u=!u)},F=()=>{l(0,i.useForCharacterCreation=!i.useForCharacterCreation,i)};function j(){i.title=this.innerText,l(0,i)}const O=()=>o("update");function k(){i.type=this.innerText,l(0,i)}const R=()=>o("update"),C=()=>{l(5,m=!m)};function L(){i.value=this.value,l(0,i)}const S=()=>o("update");function M(){i.keys=this.value,l(0,i)}const H=()=>o("update"),ee=()=>{l(3,h=!h)},ie=()=>{l(4,p=!p)};function se(){i.description=this.value,l(0,i)}const de=()=>o("update"),U=()=>{o("delete"),l(6,w=!1)},re=()=>l(6,w=!1),oe=()=>l(6,w=!1);return t.$$set=V=>{"card"in V&&l(0,i=V.card)},t.$$.update=()=>{t.$$.dirty[0]&1&&l(7,n=new Gl(i))},[i,c,u,h,p,m,w,n,s,o,_,v,T,E,N,$,I,F,j,O,k,R,C,L,S,M,H,ee,ie,se,de,U,re,oe]}class wl extends Pe{constructor(e){super(),Me(this,e,dn,fn,Oe,{card:0},null,[-1,-1])}}function Pt(t){let e,l,n,s,o,i,a,c,u,h,p,m,w,_,v,T,E,N,$,I,F,j,O,k,R,C,L,S,M,H,ee,ie,se,de,U,re,oe,V,K,X,z,q,ue,me,le,_e,B,G,te,ae,J,D,W,mt,nt,_t,Be,yt,Ge,bt,qe,kt,Ue,vt,st,wt,Ve,Ct,Ke,Tt,ot,Et,Xe,It,Ze,Nt,Qe,xe,it,St;return ee=new wl({props:{card:t[1]}}),{c(){e=f("section"),l=f("article"),n=f("h2"),n.textContent="What is all of this?",s=g(),o=f("button"),o.textContent="Oh no, text! Take me back!",i=g(),a=f("p"),a.innerHTML=`This is a tool for use with <a target="_blank" href="https://play.aidungeon.com/" class="svelte-1n65gud">AI Dungeon&#39;s</a> Story
                Cards. Story cards are chunks of text that provide additional details to the AI when one of the trigger
                words listed is mentioned. These trigger words are not case sensitive, but do take things like spaces
                into account. Since the native tools can become a bit tedious for large batches of story cards, and
                since AI Dungeon lets you export them and import them again, this tool tries to offer as many missing
                features as possible.`,c=g(),u=f("h3"),u.textContent="How do I get the cards?",h=g(),p=f("p"),p.textContent=`In the [...] menu of your scenario or adventure, there should be an Edit option. There should also be an
                Edit button on the scenario or adventure's page. Clicking that will open a nice pop-up that gives you
                access to the behind-the-scenes stuff. On the Details tab, scroll down to the bottom and you should see
                a section labeled Story Card Management (if you're on mobile, it may ask you to use your browser for
                this: go ahead and switch). Click the gray Export button to get your cards!`,m=g(),w=f("p"),w.textContent=`Alternatively, you can build everything right here! There's an Add Card button next to the file upload
                button in the header area. Clicking that will create a blank card and add it to the working set.`,_=g(),v=f("h3"),v.textContent="And how do I load my changes?",T=g(),E=f("p"),E.textContent=`It's the same thing, except click the scary red Import button and upload the edited file! You can save
                your changes here by clicking the Save button in the header: this will download a JSON file that you can
                import. Note that importing story cards will OVERWRITE ALL YOUR EXISTING CARDS IN THE STORY, so be SURE
                you select the right scenario/adventure/file when importing!`,N=g(),$=f("h3"),$.textContent="That's the AI Dungeon side. What about here?",I=g(),F=f("p"),F.textContent="There's a nice row of buttons along the top:",j=g(),O=f("ul"),O.innerHTML=`<li><strong>New Card</strong> creates a card directly, allowing you to edit its placeholder data right
                    here in the tool. This will let you create sets from scratch or add cards to existing sets.</li> <li>The <strong>From File</strong> menu lets you import cards that you&#39;ve stored locally:
                    <ul class="svelte-1n65gud"><li><strong>Import JSON</strong> adds an exported JSON file to the current set of cards.</li> <li><strong>Import Markdown...</strong> lets you load
                            <a href="https://obsidian.md" target="_blank" class="svelte-1n65gud">Obsidian</a> Markdown files (and other files
                            that follow that convention) as story cards by using the file name as the card title and its
                            contents as the entry/description. This is still experimental and may not work 100% as
                            expected. You&#39;ll get a dialog that lets you set some defaults.</li> <li><strong>Open File</strong> <em>replaces</em> the current set of cards with the contents of
                            an exported JSON file. You&#39;ll get a nice warning to confirm that this is what you want to
                            do.</li></ul></li> <li>The <strong>Save</strong> menu lets you export cards that are currently loaded:
                    <ul class="svelte-1n65gud"><li><strong>Save All Cards</strong> writes all the cards in the current session to a JSON file
                            that is compatible with AI Dungeon (and this tool, obviously).</li> <li><strong>Save Filtered Cards</strong> does the same thing, but only for the cards that are
                            being shown by the active filter.</li></ul>
                    Note that attempting to save any cards that would normally fail to import into AI Dungeon will show
                    an error. You can choose to ignore this, but you WILL lose some cards on import if you continue!</li> <li><strong>Clear Cards</strong> removes every card in the current session. Don&#39;t worry, this one comes
                    with a nice warning too. Refreshing the page will do the same thing, but without warning you!</li> <li><strong>Enable/Disable Autosave</strong> will write all updates to local storage (managed by your
                    browser) in real time. This means that if you refresh the page, your changes should still be there.
                    If Autosave is disabled, <em>no data will be written locally</em>, and refreshing the page will make
                    your changes unrecoverable! You can (and should) always save manually with the Save menu. <em>Note:
                    changes will not persist through private browsing sessions in most browsers.</em></li>`,k=g(),R=f("h3"),R.textContent="That's good and all, but how do I edit a story card?",C=g(),L=f("p"),L.textContent=`Each card pops up with a little editor window. Any changes you make here will instantly update the JSON,
                and when you're satisfied with your changes you can save the file as described above.`,S=g(),M=f("p"),M.textContent="Here's a sample you can play with. Editing this won't affect anything you have loaded.",H=g(),ve(ee.$$.fragment),ie=g(),se=f("p"),se.textContent="Some points to note:",de=g(),U=f("ul"),U.innerHTML=`<li>The â‹¯ icon toggles a drawer of card actions.
                    <ul class="svelte-1n65gud"><li><strong>Reorder</strong> lets you change the position of the story card in the set. The
                            number shows the current position: edit the value and press Enter or tap the Reorder button
                            to move it in the list!</li> <li><strong>Delete</strong> lets you delete a story card. It pops up a nice big warning message
                            asking if you&#39;re sure, just to be safe. Clicking yes on the sample card won&#39;t have any
                            effect, but on real cards it will remove it from the set.</li> <li><strong>Copy JSON</strong> puts the current card&#39;s JSON on your clipboard. Useful if you&#39;re
                            moving it to other programs or sharing the data.</li> <li><strong>Copy Markdown</strong> puts the current card&#39;s title, entry text, and trigger list
                            on your clipboard as Markdown formatted text (the same format Discord and Obsidian use).
                            Useful if you&#39;re sharing it with members of the community or moving it to Markdown-based
                            tools.</li></ul></li> <li>The âœ¨ icon button shows whether the card is visible in Character Creation. It&#39;s highlighted orange
                    if so, and shows the normal color if not. If you don&#39;t use Character Creation, you can ignore this:
                    cards will always have this enabled by default, and it doesn&#39;t affect gameplay.</li> <li>The default card types are <kbd>location</kbd>, <kbd>faction</kbd>, <kbd>class</kbd>, and
                    <kbd>race</kbd>
                    . All other card types will show up under Custom in AI Dungeon. Note that the filter
                    on here is case sensitive, so if you have <kbd>Spell</kbd> and <kbd>spell</kbd>, it will show twice
                    in the list.</li> <li>The triggers are split apart by default, preserving whitespace. When you click the edit button, it
                    will convert to the standard AI Dungeon format of a comma-separated list.</li> <li>The button in the top-right corner puts you into a full-screen editor. Clicking it again toggles it
                    back to normal.</li> <li>Most of the time, the description for a story card is meaningless. It is displayed for users if the
                    card is being used in a character creator scenario, but otherwise it&#39;s mostly used for notes. New
                    scenarios default this value to the same thing you enter in the main area. The editor hides it by
                    default, but you can click the Show Description (and subsequent Hide Description) button to toggle
                    it for the card.</li>`,re=g(),oe=f("h3"),oe.textContent="There are a bunch of tabs, what do those do?",V=g(),K=f("p"),K.textContent=`This is a central point for manipulating the list of cards. Everything in here filters the list of cards
                that you see.`,X=g(),z=f("h4"),z.textContent="Filter",q=g(),ue=f("p"),ue.textContent=`This tab has the most common ways to narrow down your cards: searching within card titles, entries, and
                triggers, as well as selecting from specific types.`,me=g(),le=f("ul"),le.innerHTML=`<li><strong>Search Filters:</strong> You can search for text (case-insensitive) within the card title,
                    entry (the part that gets sent to the AI), or triggers (the part the AI uses to add a card to the
                    context). Remember, the AI is case-insensitive too!</li> <li><strong>Card Type:</strong> You can choose to view cards that match specific types. If you want to
                    quickly deselect all of them, click Clear Types (and go back to all with Select All Types). The list
                    is multiple-selection, which means you can have more than one type active at once.</li> <li>When you&#39;re done, you can click <strong>Clear Filters</strong> to reset to the defaults.</li>`,_e=g(),B=f("h4"),B.textContent="Sort",G=g(),te=f("p"),te.textContent="This tab lets you change the order in which the cards are displayed.",ae=g(),J=f("ul"),J.innerHTML=`<li><strong>Alphabetically:</strong> Sort by card title in alphabetical order.</li> <li><strong>By type:</strong> Sort by card type in alphabetical order.</li> <li><strong>By entry length:</strong> Sort by the length of the entry text. Useful for finding overly
                    short or long cards.</li>`,D=g(),W=f("p"),W.textContent="To change the sort direction, click the Sort Ascending (or Sort Descending) button.",mt=g(),nt=f("h4"),nt.textContent="Fix Common Errors",_t=g(),Be=f("p"),Be.textContent="This tab lets you see any cards that match some common errors and oversights.",yt=g(),Ge=f("ul"),Ge.innerHTML=`<li><strong>Missing triggers:</strong> This will show cards with no triggers. The AI will NEVER load
                    these cards if present, and will fail to import these cards when you try.</li> <li><strong>No entry text:</strong> This will show cards that are missing an entry. Besides being
                    useless, they will also fail to import if you try.</li> <li><strong>Duplicate dropped on import:</strong> This will show cards that match in both trigger list
                    and card type. Because of how AI Dungeon checks for duplicate cards, if any cards match this filter,
                    all but one will fail to import! If you need duplicate triggers on the same card type, try changing
                    the order of the trigger list: AI Dungeon only cares if the <em>list</em> of keys is identical, not
                    if all the items in the list is the same.</li> <li><strong>Empty triggers:</strong> This will show cards that trigger on whitespace, or on empty text.
                    The AI will generally ALWAYS load these cards. Most of the time, this isn&#39;t what you want.</li> <li><strong>No Character Creator description:</strong> <em>If you are using Character Creator,</em> then
                    it is good practice for every Character Creator card to have a description so players know what
                    their choice means from a story standpoint. It&#39;s not required, just nice. If you are NOT using
                    Character creator, you can ignore this. Note that it will also match cards with the default text of
                    <kbd>Notes go here.</kbd>.</li>`,bt=g(),qe=f("p"),qe.textContent="There are also some quick actions available to fix common issues:",kt=g(),Ue=f("ul"),Ue.innerHTML=`<li><strong>Remove All Empty Triggers</strong> does what it says on the tin, and shows you a list of all
                    cards with empty (blank or whitespace) triggers and offers to remove those triggers from those cards
                    for you. All other triggers will remain in place.</li> <li><strong>Apply Official Cleanup Fix</strong> is a more nuanced subset of Remove All Empty Triggers,
                    taking the same approach Latitude is implementing when saving a story card and only removing the
                    <em>last</em> trigger if it&#39;s empty (blank or whitespace). If there are cards flagged for this fix,
                    you have two options: if it&#39;s a mistake, run the cleanup fix. If it&#39;s intentional, move the empty
                    trigger to the beginning or middle of the trigger list: <em>otherwise it may be removed when editing
                    your card in AI Dungeon!</em></li>`,vt=g(),st=f("h4"),st.textContent="Triggers",wt=g(),Ve=f("p"),Ve.textContent=`This tab lists all the triggers for all of the loaded cards. Clicking on a trigger will place it in the
                trigger filter box on the Filter tab, showing you only cards that match that trigger. It also highlights
                some possible oversights.`,Ct=g(),Ke=f("ul"),Ke.innerHTML=`<li>Triggers highlighted in <strong>red</strong> are duplicates. This means that more than one card uses
                    this trigger. There are times when this is what you want, but usually it&#39;s wrong. They include an
                    x<em>n</em> indicator telling you how many cards are affected.</li> <li>Triggers highlighted in <strong>orange</strong> are overlapping. This means that another trigger in
                    the list contains this trigger, effectively making it a one-way duplicate (e.g. the trigger &quot;elf&quot;
                    will also trigger &quot;half-elf&quot;). This may be necessary, or even desired, but often means you should
                    rethink your trigger design. They include a +<em>n</em> indicator telling you how many cards are
                    affected.</li>`,Tt=g(),ot=f("h3"),ot.textContent="Something's broken/I have a cool idea/I just wanna say thanks",Et=g(),Xe=f("p"),Xe.innerHTML=`Hop in the <a target="_blank" href="https://discord.com/invite/HB2YBZYjyf" class="svelte-1n65gud">AI Dungeon Discord server</a>
                and check out the
                <a target="_blank" href="https://discord.com/channels/903327676884979802/1214767285655576696" class="svelte-1n65gud">thread
                under the sharing section</a> to give any feedback! You can also
                <a target="_blank" href="https://github.com/ndm13/aid-json-helper/issues" class="svelte-1n65gud">open an issue</a> on the
                project&#39;s <a target="_blank" href="https://github.com/ndm13/aid-json-helper/" class="svelte-1n65gud">GitHub page</a>, but
                there&#39;s no guarantee I&#39;ll get to it in a timely manner. This is a very casual project for me, but when
                the community is engaged it motivates me to work on it.`,It=g(),Ze=f("p"),Ze.textContent=`The more technical questions (how it's built/deployed/developed) are probably answered on that GitHub
                page too.`,Nt=g(),Qe=f("button"),Qe.textContent="Okay, got it!",d(a,"class","svelte-1n65gud"),d(p,"class","svelte-1n65gud"),d(w,"class","svelte-1n65gud"),d(E,"class","svelte-1n65gud"),d(F,"class","svelte-1n65gud"),d(O,"class","svelte-1n65gud"),d(L,"class","svelte-1n65gud"),d(M,"class","svelte-1n65gud"),d(se,"class","svelte-1n65gud"),d(U,"class","svelte-1n65gud"),d(K,"class","svelte-1n65gud"),d(ue,"class","svelte-1n65gud"),d(le,"class","svelte-1n65gud"),d(te,"class","svelte-1n65gud"),d(J,"class","svelte-1n65gud"),d(W,"class","svelte-1n65gud"),d(Be,"class","svelte-1n65gud"),d(Ge,"class","svelte-1n65gud"),d(qe,"class","svelte-1n65gud"),d(Ue,"class","svelte-1n65gud"),d(Ve,"class","svelte-1n65gud"),d(Ke,"class","svelte-1n65gud"),d(Xe,"class","svelte-1n65gud"),d(Ze,"class","svelte-1n65gud"),d(l,"class","svelte-1n65gud"),d(e,"class","svelte-1n65gud")},m(Ne,Cl){b(Ne,e,Cl),r(e,l),r(l,n),r(l,s),r(l,o),r(l,i),r(l,a),r(l,c),r(l,u),r(l,h),r(l,p),r(l,m),r(l,w),r(l,_),r(l,v),r(l,T),r(l,E),r(l,N),r(l,$),r(l,I),r(l,F),r(l,j),r(l,O),r(l,k),r(l,R),r(l,C),r(l,L),r(l,S),r(l,M),r(l,H),be(ee,l,null),r(l,ie),r(l,se),r(l,de),r(l,U),r(l,re),r(l,oe),r(l,V),r(l,K),r(l,X),r(l,z),r(l,q),r(l,ue),r(l,me),r(l,le),r(l,_e),r(l,B),r(l,G),r(l,te),r(l,ae),r(l,J),r(l,D),r(l,W),r(l,mt),r(l,nt),r(l,_t),r(l,Be),r(l,yt),r(l,Ge),r(l,bt),r(l,qe),r(l,kt),r(l,Ue),r(l,vt),r(l,st),r(l,wt),r(l,Ve),r(l,Ct),r(l,Ke),r(l,Tt),r(l,ot),r(l,Et),r(l,Xe),r(l,It),r(l,Ze),r(l,Nt),r(l,Qe),xe=!0,it||(St=[A(o,"click",t[3]),A(Qe,"click",t[4])],it=!0)},p:he,i(Ne){xe||(P(ee.$$.fragment,Ne),xe=!0)},o(Ne){Z(ee.$$.fragment,Ne),xe=!1},d(Ne){Ne&&y(e),ke(ee),it=!1,ge(St)}}}function hn(t){let e,l,n,s,o,i,a=t[0]&&Pt(t);return{c(){e=f("button"),e.textContent="What is all of this?",l=g(),a&&a.c(),n=He()},m(c,u){b(c,e,u),b(c,l,u),a&&a.m(c,u),b(c,n,u),s=!0,o||(i=A(e,"click",t[2]),o=!0)},p(c,[u]){c[0]?a?(a.p(c,u),u&1&&P(a,1)):(a=Pt(c),a.c(),P(a,1),a.m(n.parentNode,n)):a&&(Ce(),Z(a,1,1,()=>{a=null}),Te())},i(c){s||(P(a),s=!0)},o(c){Z(a),s=!1},d(c){c&&(y(e),y(l),y(n)),a&&a.d(c),o=!1,i()}}}function pn(t,e,l){let n=!1;return[n,{title:"Title of Your Card",value:"This is the part that gets sent to the AI.",useForCharacterCreation:!0,keys:"words,that,trigger,the ai,and can include, leading,and trailing ,spaces",description:"This is the part that gets shown to the user in Character Creator, or a space for notes.",type:"Card Type"},()=>l(0,n=!0),()=>l(0,n=!1),()=>l(0,n=!1)]}class gn extends Pe{constructor(e){super(),Me(this,e,pn,hn,Oe,{})}}class mn{constructor(){this.triggers=Je(ce,e=>{const l=e.map(s=>s.keys.split(",")).reduce((s,o)=>(o.forEach(i=>s[i]?s[i].count++:s[i]={count:1}),s),{}),n=Object.keys(l);return n.forEach(s=>l[s].overlap=n.filter(o=>o.indexOf(s)>-1&&s!==o).length),Object.entries(l).map(([s,o])=>(o.key=s,o))}),this.cardsWithEmptyTriggers=Je(ce,e=>e.filter(_l)),this.cardsWithOfficialCleanupFail=Je(ce,e=>e.filter(Ft))}removeEmptyTriggers(){ce.update(e=>e.map(l=>(l.keys=l.keys.split(",").filter(n=>!ml.test(n)).join(","),l)))}applyCleanupFix(){ce.update(e=>e.map(l=>(Ft(l)&&(l.keys=l.keys.trimEnd().slice(0,-1)),l)))}}function jt(t,e,l){const n=t.slice();return n[44]=e[l],n}function Jt(t,e,l){const n=t.slice();return n[44]=e[l],n}function Wt(t,e,l){const n=t.slice();return n[52]=e[l],n}function Bt(t,e,l){const n=t.slice();return n[49]=e[l],n}function _n(t){let e,l=pe(t[3]),n=[];for(let o=0;o<l.length;o+=1)n[o]=qt(Wt(t,l,o));let s=null;return l.length||(s=Gt()),{c(){e=f("section");for(let o=0;o<n.length;o+=1)n[o].c();s&&s.c(),d(e,"class","triggers svelte-ytk9tl")},m(o,i){b(o,e,i);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(e,null);s&&s.m(e,null)},p(o,i){if(i[0]&40){l=pe(o[3]);let a;for(a=0;a<l.length;a+=1){const c=Wt(o,l,a);n[a]?n[a].p(c,i):(n[a]=qt(c),n[a].c(),n[a].m(e,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=l.length,!l.length&&s?s.p(o,i):l.length?s&&(s.d(1),s=null):(s=Gt(),s.c(),s.m(e,null))}},d(o){o&&y(e),Ie(n,o),s&&s.d()}}}function yn(t){let e,l,n,s,o,i,a,c,u,h,p,m,w,_,v,T,E,N,$,I,F,j,O,k,R,C,L,S,M,H,ee,ie,se,de,U,re,oe,V=t[7].length+"",K,X,z,q,ue,me,le=t[8].length+"",_e,B,G,te,ae;return{c(){e=f("section"),l=f("small"),l.textContent="Issues that will prevent import:",n=g(),s=f("div"),o=f("span"),i=f("input"),a=g(),c=f("label"),c.textContent="Missing triggers",u=g(),h=f("span"),p=f("input"),m=g(),w=f("label"),w.textContent="No entry text",_=g(),v=f("span"),T=f("input"),E=g(),N=f("label"),N.textContent="Duplicate dropped on import",$=g(),I=f("small"),I.textContent="Issues that affect usability:",F=g(),j=f("div"),O=f("span"),k=f("input"),R=g(),C=f("label"),C.textContent="Empty triggers",L=g(),S=f("span"),M=f("input"),H=g(),ee=f("label"),ee.textContent="No Character Creator description",ie=g(),se=f("small"),se.textContent="Automatically fix:",de=g(),U=f("div"),re=f("button"),oe=Y("Remove All Empty Triggers ("),K=Y(V),X=Y(")"),q=g(),ue=f("button"),me=Y("Apply Official Cleanup Fix ("),_e=Y(le),B=Y(")"),d(i,"title","Shows cards with missing triggers. Cards without triggers will fail to import."),d(i,"type","checkbox"),d(i,"id","missing"),d(i,"name","missing"),d(c,"for","missing"),d(o,"class","svelte-ytk9tl"),d(p,"title","Shows cards with no entry text. Cards with no entry text will fail to import."),d(p,"type","checkbox"),d(p,"id","noEntryText"),d(p,"name","noEntryText"),d(w,"for","noEntryText"),d(h,"class","svelte-ytk9tl"),d(T,"title","Shows cards that overlap in type and triggers. Import will fail for all but one!"),d(T,"type","checkbox"),d(T,"id","duplicateImport"),d(T,"name","duplicateImport"),d(N,"for","duplicateImport"),d(v,"class","svelte-ytk9tl"),d(s,"class","rowflow svelte-ytk9tl"),d(k,"title","Shows cards with empty triggers. Empty triggers will cause cards to trigger constantly."),d(k,"type","checkbox"),d(k,"id","empty"),d(k,"name","empty"),d(C,"for","empty"),d(O,"class","svelte-ytk9tl"),d(M,"title","Shows cards that are shown in character creator, but have no description. This only applies if you use character creator!"),d(M,"type","checkbox"),d(M,"id","noDescription"),d(M,"name","noDescription"),d(ee,"for","noDescription"),d(S,"class","svelte-ytk9tl"),d(j,"class","rowflow svelte-ytk9tl"),re.disabled=z=t[7].length===0,d(re,"class","svelte-ytk9tl"),ue.disabled=G=t[8].length===0,d(ue,"class","svelte-ytk9tl"),d(U,"class","rowflow svelte-ytk9tl"),d(e,"class","issues svelte-ytk9tl")},m(J,D){b(J,e,D),r(e,l),r(e,n),r(e,s),r(s,o),r(o,i),i.checked=t[5].missing,r(o,a),r(o,c),r(s,u),r(s,h),r(h,p),p.checked=t[5].noEntryText,r(h,m),r(h,w),r(s,_),r(s,v),r(v,T),T.checked=t[5].duplicateImport,r(v,E),r(v,N),r(e,$),r(e,I),r(e,F),r(e,j),r(j,O),r(O,k),k.checked=t[5].emptyTriggers,r(O,R),r(O,C),r(j,L),r(j,S),r(S,M),M.checked=t[5].noDescription,r(S,H),r(S,ee),r(e,ie),r(e,se),r(e,de),r(e,U),r(U,re),r(re,oe),r(re,K),r(re,X),r(U,q),r(U,ue),r(ue,me),r(ue,_e),r(ue,B),te||(ae=[A(i,"change",t[30]),A(p,"change",t[31]),A(T,"change",t[32]),A(k,"change",t[33]),A(M,"change",t[34]),A(re,"click",t[35]),A(ue,"click",t[36])],te=!0)},p(J,D){D[0]&96&&(i.checked=J[5].missing),D[0]&96&&(p.checked=J[5].noEntryText),D[0]&96&&(T.checked=J[5].duplicateImport),D[0]&96&&(k.checked=J[5].emptyTriggers),D[0]&96&&(M.checked=J[5].noDescription),D[0]&128&&V!==(V=J[7].length+"")&&x(K,V),D[0]&128&&z!==(z=J[7].length===0)&&(re.disabled=z),D[0]&256&&le!==(le=J[8].length+"")&&x(_e,le),D[0]&256&&G!==(G=J[8].length===0)&&(ue.disabled=G)},d(J){J&&y(e),te=!1,ge(ae)}}}function bn(t){let e,l,n,s,o,i,a,c,u,h,p,m,w,_,v,T,E,N,$,I,F,j=t[5].sort.asc?"Descending":"Ascending",O,k,R,C;return k=$l(t[26][0]),{c(){e=f("section"),l=f("small"),l.textContent="Sorting type:",n=g(),s=f("div"),o=f("span"),i=f("input"),a=g(),c=f("label"),c.textContent="Alphabetically",u=g(),h=f("span"),p=f("input"),m=g(),w=f("label"),w.textContent="By type",_=g(),v=f("span"),T=f("input"),E=g(),N=f("label"),N.textContent="By entry length",$=g(),I=f("button"),F=Y("Sort "),O=Y(j),d(i,"type","radio"),d(i,"id","alpha"),d(i,"name","sort"),i.__value=Ee.ALPHA,fe(i,i.__value),d(c,"for","alpha"),d(o,"class","svelte-ytk9tl"),d(p,"type","radio"),d(p,"id","type"),d(p,"name","sort"),p.__value=Ee.TYPE,fe(p,p.__value),d(w,"for","type"),d(h,"class","svelte-ytk9tl"),d(T,"type","radio"),d(T,"id","length"),d(T,"name","sort"),T.__value=Ee.LENGTH,fe(T,T.__value),d(N,"for","length"),d(v,"class","svelte-ytk9tl"),d(s,"class","rowflow svelte-ytk9tl"),d(e,"class","sort svelte-ytk9tl"),k.p(i,p,T)},m(L,S){b(L,e,S),r(e,l),r(e,n),r(e,s),r(s,o),r(o,i),i.checked=i.__value===t[5].sort.mode,r(o,a),r(o,c),r(s,u),r(s,h),r(h,p),p.checked=p.__value===t[5].sort.mode,r(h,m),r(h,w),r(s,_),r(s,v),r(v,T),T.checked=T.__value===t[5].sort.mode,r(v,E),r(v,N),r(e,$),r(e,I),r(I,F),r(I,O),R||(C=[A(i,"change",t[25]),A(p,"change",t[27]),A(T,"change",t[28]),A(I,"click",t[29])],R=!0)},p(L,S){S[0]&96&&(i.checked=i.__value===L[5].sort.mode),S[0]&96&&(p.checked=p.__value===L[5].sort.mode),S[0]&96&&(T.checked=T.__value===L[5].sort.mode),S[0]&32&&j!==(j=L[5].sort.asc?"Descending":"Ascending")&&x(O,j)},d(L){L&&y(e),k.r(),R=!1,ge(C)}}}function kn(t){let e;function l(o,i){return o[4].length===0?wn:vn}let n=l(t),s=n(t);return{c(){e=f("section"),s.c(),d(e,"class","filter svelte-ytk9tl")},m(o,i){b(o,e,i),s.m(e,null)},p(o,i){n===(n=l(o))&&s?s.p(o,i):(s.d(1),s=n(o),s&&(s.c(),s.m(e,null)))},d(o){o&&y(e),s.d()}}}function Gt(t){let e;return{c(){e=f("p"),e.textContent="No triggers loaded!",d(e,"class","svelte-ytk9tl")},m(l,n){b(l,e,n)},p:he,d(l){l&&y(e)}}}function qt(t){let e,l=t[52].key+"",n,s=t[52].count>1?" x"+t[52].count:"",o,i=t[52].overlap>0?" +"+t[52].overlap:"",a,c,u;function h(){return t[37](t[52])}return{c(){e=f("kbd"),n=Y(l),o=Y(s),a=Y(i),d(e,"class","svelte-ytk9tl"),ne(e,"plural",t[52].count>1),ne(e,"overlap",t[52].overlap>0)},m(p,m){b(p,e,m),r(e,n),r(e,o),r(e,a),c||(u=A(e,"click",h),c=!0)},p(p,m){t=p,m[0]&8&&l!==(l=t[52].key+"")&&x(n,l),m[0]&8&&s!==(s=t[52].count>1?" x"+t[52].count:"")&&x(o,s),m[0]&8&&i!==(i=t[52].overlap>0?" +"+t[52].overlap:"")&&x(a,i),m[0]&8&&ne(e,"plural",t[52].count>1),m[0]&8&&ne(e,"overlap",t[52].overlap>0)},d(p){p&&y(e),c=!1,u()}}}function vn(t){let e,l,n,s,o,i,a,c,u,h,p,m,w,_,v,T,E,N,$,I,F,j,O=pe(t[6]),k=[];for(let S=0;S<O.length;S+=1)k[S]=Ut(Bt(t,O,S));function R(S,M){return S[5].types.length===0&&S[6].length>0?Tn:Cn}let C=R(t),L=C(t);return{c(){e=f("fieldset"),l=f("label"),l.textContent="Title:",n=g(),s=f("input"),o=g(),i=f("label"),i.textContent="Entry:",a=g(),c=f("input"),u=g(),h=f("label"),h.textContent="Trigger:",p=g(),m=f("input"),w=g(),_=f("fieldset"),v=f("label"),v.textContent="Type:",T=g(),E=f("select");for(let S=0;S<k.length;S+=1)k[S].c();N=g(),L.c(),$=g(),I=f("button"),I.textContent="Clear Filters",d(l,"for","title"),d(l,"class","svelte-ytk9tl"),d(s,"name","title"),d(s,"id","title"),d(i,"for","entry"),d(i,"class","svelte-ytk9tl"),d(c,"name","entry"),d(c,"id","entry"),d(h,"for","triggers"),d(h,"class","svelte-ytk9tl"),d(m,"name","triggers"),d(m,"id","triggers"),d(e,"class","searchWithin svelte-ytk9tl"),d(v,"for","type"),d(E,"name","type"),E.multiple=!0,t[5].types===void 0&&ze(()=>t[21].call(E)),d(_,"class","type svelte-ytk9tl")},m(S,M){b(S,e,M),r(e,l),r(e,n),r(e,s),fe(s,t[5].title),r(e,o),r(e,i),r(e,a),r(e,c),fe(c,t[5].value),r(e,u),r(e,h),r(e,p),r(e,m),fe(m,t[5].key),b(S,w,M),b(S,_,M),r(_,v),r(_,T),r(_,E);for(let H=0;H<k.length;H+=1)k[H]&&k[H].m(E,null);Ot(E,t[5].types),r(_,N),L.m(_,null),b(S,$,M),b(S,I,M),F||(j=[A(s,"input",t[18]),A(c,"input",t[19]),A(m,"input",t[20]),A(E,"change",t[21]),A(I,"click",t[24])],F=!0)},p(S,M){if(M[0]&96&&s.value!==S[5].title&&fe(s,S[5].title),M[0]&96&&c.value!==S[5].value&&fe(c,S[5].value),M[0]&96&&m.value!==S[5].key&&fe(m,S[5].key),M[0]&64){O=pe(S[6]);let H;for(H=0;H<O.length;H+=1){const ee=Bt(S,O,H);k[H]?k[H].p(ee,M):(k[H]=Ut(ee),k[H].c(),k[H].m(E,null))}for(;H<k.length;H+=1)k[H].d(1);k.length=O.length}M[0]&96&&Ot(E,S[5].types),C===(C=R(S))&&L?L.p(S,M):(L.d(1),L=C(S),L&&(L.c(),L.m(_,null)))},d(S){S&&(y(e),y(w),y(_),y($),y(I)),Ie(k,S),L.d(),F=!1,ge(j)}}}function wn(t){let e;return{c(){e=f("p"),e.textContent="No cards loaded: nothing to filter!"},m(l,n){b(l,e,n)},p:he,d(l){l&&y(e)}}}function Ut(t){let e,l=t[49]+"",n,s;return{c(){e=f("option"),n=Y(l),e.selected=!0,e.__value=s=t[49],fe(e,e.__value)},m(o,i){b(o,e,i),r(e,n)},p(o,i){i[0]&64&&l!==(l=o[49]+"")&&x(n,l),i[0]&64&&s!==(s=o[49])&&(e.__value=s,fe(e,e.__value))},d(o){o&&y(e)}}}function Cn(t){let e,l,n;return{c(){e=f("button"),e.textContent="Clear Types"},m(s,o){b(s,e,o),l||(n=A(e,"click",t[23]),l=!0)},p:he,d(s){s&&y(e),l=!1,n()}}}function Tn(t){let e,l,n;return{c(){e=f("button"),e.textContent="Select All Types"},m(s,o){b(s,e,o),l||(n=A(e,"click",t[22]),l=!0)},p:he,d(s){s&&y(e),l=!1,n()}}}function Vt(t){let e,l;return e=new Re({props:{title:`Remove empty triggers from ${t[7].length} card${t[7].length===1?"":"s"}?`,options:["Yes","No"],$$slots:{default:[En]},$$scope:{ctx:t}}}),e.$on("optionYes",t[38]),e.$on("optionNo",t[39]),e.$on("close",t[40]),{c(){ve(e.$$.fragment)},m(n,s){be(e,n,s),l=!0},p(n,s){const o={};s[0]&128&&(o.title=`Remove empty triggers from ${n[7].length} card${n[7].length===1?"":"s"}?`),s[0]&128|s[1]&16777216&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){l||(P(e.$$.fragment,n),l=!0)},o(n){Z(e.$$.fragment,n),l=!1},d(n){ke(e,n)}}}function Kt(t){let e,l,n=t[44].title+"",s,o,i,a=t[44].type+"",c;return{c(){e=f("li"),l=f("strong"),s=Y(n),o=g(),i=f("em"),c=Y(a)},m(u,h){b(u,e,h),r(e,l),r(l,s),r(e,o),r(e,i),r(i,c)},p(u,h){h[0]&128&&n!==(n=u[44].title+"")&&x(s,n),h[0]&128&&a!==(a=u[44].type+"")&&x(c,a)},d(u){u&&y(e)}}}function En(t){let e,l,n,s,o,i,a,c=pe(t[7]),u=[];for(let h=0;h<c.length;h+=1)u[h]=Kt(Jt(t,c,h));return{c(){e=f("p"),e.textContent="Are you sure you want to remove empty triggers from ALL cards?",l=g(),n=f("p"),n.textContent="The following cards will be affected:",s=g(),o=f("ul");for(let h=0;h<u.length;h+=1)u[h].c();i=g(),a=f("em"),a.textContent="Hint: to remove an empty trigger from a specific card, you can edit its trigger list.",d(o,"class","svelte-ytk9tl")},m(h,p){b(h,e,p),b(h,l,p),b(h,n,p),b(h,s,p),b(h,o,p);for(let m=0;m<u.length;m+=1)u[m]&&u[m].m(o,null);b(h,i,p),b(h,a,p)},p(h,p){if(p[0]&128){c=pe(h[7]);let m;for(m=0;m<c.length;m+=1){const w=Jt(h,c,m);u[m]?u[m].p(w,p):(u[m]=Kt(w),u[m].c(),u[m].m(o,null))}for(;m<u.length;m+=1)u[m].d(1);u.length=c.length}},d(h){h&&(y(e),y(l),y(n),y(s),y(o),y(i),y(a)),Ie(u,h)}}}function Xt(t){let e,l;return e=new Re({props:{title:`Apply cleanup fix to ${t[8].length} card${t[8].length===1?"":"s"}?`,options:["Yes","No"],$$slots:{default:[In]},$$scope:{ctx:t}}}),e.$on("optionYes",t[41]),e.$on("optionNo",t[42]),e.$on("close",t[43]),{c(){ve(e.$$.fragment)},m(n,s){be(e,n,s),l=!0},p(n,s){const o={};s[0]&256&&(o.title=`Apply cleanup fix to ${n[8].length} card${n[8].length===1?"":"s"}?`),s[0]&256|s[1]&16777216&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){l||(P(e.$$.fragment,n),l=!0)},o(n){Z(e.$$.fragment,n),l=!1},d(n){ke(e,n)}}}function Zt(t){let e,l,n=t[44].title+"",s,o,i,a=t[44].type+"",c;return{c(){e=f("li"),l=f("strong"),s=Y(n),o=g(),i=f("em"),c=Y(a)},m(u,h){b(u,e,h),r(e,l),r(l,s),r(e,o),r(e,i),r(i,c)},p(u,h){h[0]&256&&n!==(n=u[44].title+"")&&x(s,n),h[0]&256&&a!==(a=u[44].type+"")&&x(c,a)},d(u){u&&y(e)}}}function In(t){let e,l,n,s,o,i,a,c,u,h=pe(t[8]),p=[];for(let m=0;m<h.length;m+=1)p[m]=Zt(jt(t,h,m));return{c(){e=f("p"),e.innerHTML=`Latitude recently rolled out a fix for some trigger-related bugs intended to catch dangling commas and
            whitespace. This fix is automatically applied when saving story cards, but does not affect imported or
            existing cards. You should apply this fix to prevent unexpected behavior in the future. Note that this
            doesn&#39;t remove ALL empty triggers:
            <a href="https://discord.com/channels/903327676884979802/1231032986414092318/1231367605470625823">this is
            intentional</a>.`,l=g(),n=f("p"),n.innerHTML=`<strong>If you need empty trigger behavior, include it via <kbd>, ,</kbd> or <kbd>,</kbd> at the start of
                your list of keys!</strong>`,s=g(),o=f("p"),o.textContent="The following cards will be affected:",i=g(),a=f("ul");for(let m=0;m<p.length;m+=1)p[m].c();c=g(),u=f("em"),u.textContent="Hint: to remove an empty trigger from a specific card, you can edit its trigger list.",d(a,"class","svelte-ytk9tl")},m(m,w){b(m,e,w),b(m,l,w),b(m,n,w),b(m,s,w),b(m,o,w),b(m,i,w),b(m,a,w);for(let _=0;_<p.length;_+=1)p[_]&&p[_].m(a,null);b(m,c,w),b(m,u,w)},p(m,w){if(w[0]&256){h=pe(m[8]);let _;for(_=0;_<h.length;_+=1){const v=jt(m,h,_);p[_]?p[_].p(v,w):(p[_]=Zt(v),p[_].c(),p[_].m(a,null))}for(;_<p.length;_+=1)p[_].d(1);p.length=h.length}},d(m){m&&(y(e),y(l),y(n),y(s),y(o),y(i),y(a),y(c),y(u)),Ie(p,m)}}}function Nn(t){let e,l,n,s,o,i,a,c,u,h,p=Object.keys(t[3]).length+"",m,w,_,v,T,E,N,$,I;function F(C,L){return C[0]===C[13].FILTER?kn:C[0]===C[13].SORT?bn:C[0]===C[13].ERROR?yn:_n}let j=F(t),O=j(t),k=t[1]&&Vt(t),R=t[2]&&Xt(t);return{c(){e=f("nav"),l=f("div"),n=f("span"),n.textContent="Filter",s=g(),o=f("span"),o.textContent="Sort",i=g(),a=f("span"),a.textContent="Fix Common Errors",c=g(),u=f("span"),h=Y("Triggers ("),m=Y(p),w=Y(")"),_=g(),O.c(),v=g(),k&&k.c(),T=g(),R&&R.c(),E=He(),d(n,"class","svelte-ytk9tl"),ne(n,"focus",t[0]===t[13].FILTER),d(o,"class","svelte-ytk9tl"),ne(o,"focus",t[0]===t[13].SORT),d(a,"class","svelte-ytk9tl"),ne(a,"focus",t[0]===t[13].ERROR),d(u,"class","svelte-ytk9tl"),ne(u,"focus",t[0]===t[13].TRIGGER),d(l,"class","tabs svelte-ytk9tl"),d(e,"class","svelte-ytk9tl")},m(C,L){b(C,e,L),r(e,l),r(l,n),r(l,s),r(l,o),r(l,i),r(l,a),r(l,c),r(l,u),r(u,h),r(u,m),r(u,w),r(e,_),O.m(e,null),b(C,v,L),k&&k.m(C,L),b(C,T,L),R&&R.m(C,L),b(C,E,L),N=!0,$||(I=[A(n,"click",t[14]),A(o,"click",t[15]),A(a,"click",t[16]),A(u,"click",t[17])],$=!0)},p(C,L){(!N||L[0]&8193)&&ne(n,"focus",C[0]===C[13].FILTER),(!N||L[0]&8193)&&ne(o,"focus",C[0]===C[13].SORT),(!N||L[0]&8193)&&ne(a,"focus",C[0]===C[13].ERROR),(!N||L[0]&8)&&p!==(p=Object.keys(C[3]).length+"")&&x(m,p),(!N||L[0]&8193)&&ne(u,"focus",C[0]===C[13].TRIGGER),j===(j=F(C))&&O?O.p(C,L):(O.d(1),O=j(C),O&&(O.c(),O.m(e,null))),C[1]?k?(k.p(C,L),L[0]&2&&P(k,1)):(k=Vt(C),k.c(),P(k,1),k.m(T.parentNode,T)):k&&(Ce(),Z(k,1,1,()=>{k=null}),Te()),C[2]?R?(R.p(C,L),L[0]&4&&P(R,1)):(R=Xt(C),R.c(),P(R,1),R.m(E.parentNode,E)):R&&(Ce(),Z(R,1,1,()=>{R=null}),Te())},i(C){N||(P(k),P(R),N=!0)},o(C){Z(k),Z(R),N=!1},d(C){C&&(y(e),y(v),y(T),y(E)),O.d(),k&&k.d(C),R&&R.d(C),$=!1,ge(I)}}}function Sn(t,e,l){let n,s,o,i,a,c;ye(t,ce,B=>l(4,s=B)),ye(t,Q,B=>l(5,o=B)),ye(t,kl,B=>l(6,i=B));const u=new mn,{triggers:h,cardsWithOfficialCleanupFail:p,cardsWithEmptyTriggers:m}=u;ye(t,h,B=>l(3,n=B)),ye(t,p,B=>l(8,c=B)),ye(t,m,B=>l(7,a=B));var w=(B=>(B[B.FILTER=0]="FILTER",B[B.SORT=1]="SORT",B[B.ERROR=2]="ERROR",B[B.TRIGGER=3]="TRIGGER",B))(w||{});let _=0,v=!1,T=!1;const E=[[]],N=()=>l(0,_=w.FILTER),$=()=>l(0,_=w.SORT),I=()=>l(0,_=w.ERROR),F=()=>l(0,_=w.TRIGGER);function j(){o.title=this.value,Q.set(o)}function O(){o.value=this.value,Q.set(o)}function k(){o.key=this.value,Q.set(o)}function R(){o.types=Dl(this),Q.set(o)}const C=()=>Se(Q,o.types=i,o),L=()=>Se(Q,o.types=[],o),S=()=>Q.reset();function M(){o.sort.mode=this.__value,Q.set(o)}function H(){o.sort.mode=this.__value,Q.set(o)}function ee(){o.sort.mode=this.__value,Q.set(o)}const ie=()=>Se(Q,o.sort.asc=!o.sort.asc,o);function se(){o.missing=this.checked,Q.set(o)}function de(){o.noEntryText=this.checked,Q.set(o)}function U(){o.duplicateImport=this.checked,Q.set(o)}function re(){o.emptyTriggers=this.checked,Q.set(o)}function oe(){o.noDescription=this.checked,Q.set(o)}return[_,v,T,n,s,o,i,a,c,u,h,p,m,w,N,$,I,F,j,O,k,R,C,L,S,M,E,H,ee,ie,se,de,U,re,oe,()=>l(1,v=!0),()=>l(2,T=!0),B=>{Q.reset(),B.key===""?Se(Q,o.empty=!0,o):Se(Q,o.key=B.key,o)},()=>{l(1,v=!1),u.removeEmptyTriggers()},()=>l(1,v=!1),()=>l(1,v=!1),()=>{l(2,T=!1),u.applyCleanupFix()},()=>l(2,T=!1),()=>l(2,T=!1)]}class An extends Pe{constructor(e){super(),Me(this,e,Sn,Nn,Oe,{},null,[-1,-1])}}var ut=(t=>(t[t.APPEND=0]="APPEND",t[t.REPLACE=1]="REPLACE",t))(ut||{}),ft=(t=>(t[t.ALL=0]="ALL",t[t.FILTERED=1]="FILTERED",t))(ft||{});class gt{addCard(){const e=we(Q),l=e.types.length===1;let n=gt.newCard();l&&(n.type=e.types[0]),ce.update(s=>[n,...s]),l||Q.update(s=>(s.types.indexOf("placeholder")<0&&(s.types=["placeholder",...s.types]),s))}async loadMd(e,l,n){const s=[];for(const o of e){const i=(await o.text()).trim(),a=o.name.split(".").slice(0,-1).join(".").trim();s.push({title:a,value:i,type:n,keys:a,useForCharacterCreation:l,description:i})}ce.update(o=>[...s,...o]),we(Q).types.indexOf(n)<0&&Q.update(o=>(o.types.push(n),o))}async loadJson(e,l){const n=[];for(const s of e)await s.text().then(o=>JSON.parse(o)).then(o=>n.push(...o));if(n.length===0){alert("This file doesn't contain any story cards!  Make sure you have the right file.");return}else{switch(l){case 1:ce.set(n);break;case 0:ce.update(s=>[...n,...s]);break}Q.reset(),this.fileName=e[0].name}}checkProblemCards(e){let l;switch(e){case 0:l=we(ce);break;case 1:l=we(tt);break}const n=l.filter(o=>o.keys===""||o.value===""),s=l.filter(o=>l.find(i=>o!==i&&o.type===i.type&&o.keys===i.keys));return{dropped:n,dupe:s}}download(e){let l;switch(e){case 0:l=we(ce);break;case 1:l=we(tt);break}const n=document.createElement("a"),s=URL.createObjectURL(new Blob([JSON.stringify(l)],{type:"application/json"}));n.download=this.fileName??`storycards-${l.length}.json`,n.href=s,n.click(),URL.revokeObjectURL(s)}static newCard(){return{keys:"",value:"",type:"placeholder",description:"",useForCharacterCreation:!0,title:"New Card"}}}function Qt(t,e,l){const n=t.slice();return n[45]=e[l],n}function xt(t,e,l){const n=t.slice();return n[45]=e[l],n}function el(t){let e,l;return e=new Re({props:{title:"Replace all cards?",options:["Yes","No"],$$slots:{default:[On]},$$scope:{ctx:t}}}),e.$on("optionYes",t[31]),e.$on("optionNo",t[32]),e.$on("close",t[33]),{c(){ve(e.$$.fragment)},m(n,s){be(e,n,s),l=!0},p(n,s){const o={};s[1]&524288&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){l||(P(e.$$.fragment,n),l=!0)},o(n){Z(e.$$.fragment,n),l=!1},d(n){ke(e,n)}}}function On(t){let e,l,n;return{c(){e=f("p"),e.textContent="Are you sure you want to open a new file? This will overwrite any loaded cards.",l=g(),n=f("em"),n.textContent='Hint: to add cards instead, use "Import File".'},m(s,o){b(s,e,o),b(s,l,o),b(s,n,o)},p:he,d(s){s&&(y(e),y(l),y(n))}}}function tl(t){let e,l;return e=new Re({props:{title:"Delete all cards?",options:["Yes","No"],$$slots:{default:[Rn]},$$scope:{ctx:t}}}),e.$on("optionYes",t[34]),e.$on("optionNo",t[35]),e.$on("close",t[36]),{c(){ve(e.$$.fragment)},m(n,s){be(e,n,s),l=!0},p(n,s){const o={};s[1]&524288&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){l||(P(e.$$.fragment,n),l=!0)},o(n){Z(e.$$.fragment,n),l=!1},d(n){ke(e,n)}}}function Rn(t){let e,l,n;return{c(){e=f("p"),e.textContent="Are you sure you want to clear all cards? This cannot be undone.",l=g(),n=f("em"),n.textContent="Hint: to remove a specific card, use the icon in the top-left corner of the card."},m(s,o){b(s,e,o),b(s,l,o),b(s,n,o)},p:he,d(s){s&&(y(e),y(l),y(n))}}}function ll(t){let e,l;return e=new Re({props:{title:"Save incompatible cards?",options:["Yes","No"],$$slots:{default:[$n]},$$scope:{ctx:t}}}),e.$on("optionYes",t[37]),e.$on("optionNo",t[38]),e.$on("close",t[39]),{c(){ve(e.$$.fragment)},m(n,s){be(e,n,s),l=!0},p(n,s){const o={};s[0]&4|s[1]&524288&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){l||(P(e.$$.fragment,n),l=!0)},o(n){Z(e.$$.fragment,n),l=!1},d(n){ke(e,n)}}}function nl(t){let e,l,n,s=pe(t[2].dropped),o=[];for(let i=0;i<s.length;i+=1)o[i]=sl(xt(t,s,i));return{c(){e=f("p"),e.textContent="The following cards will fail to import:",l=g(),n=f("ul");for(let i=0;i<o.length;i+=1)o[i].c();d(n,"class","svelte-zpy4zv")},m(i,a){b(i,e,a),b(i,l,a),b(i,n,a);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(n,null)},p(i,a){if(a[0]&4){s=pe(i[2].dropped);let c;for(c=0;c<s.length;c+=1){const u=xt(i,s,c);o[c]?o[c].p(u,a):(o[c]=sl(u),o[c].c(),o[c].m(n,null))}for(;c<o.length;c+=1)o[c].d(1);o.length=s.length}},d(i){i&&(y(e),y(l),y(n)),Ie(o,i)}}}function sl(t){let e,l,n=t[45].title+"",s,o,i,a=t[45].type+"",c;return{c(){e=f("li"),l=f("strong"),s=Y(n),o=g(),i=f("em"),c=Y(a)},m(u,h){b(u,e,h),r(e,l),r(l,s),r(e,o),r(e,i),r(i,c)},p(u,h){h[0]&4&&n!==(n=u[45].title+"")&&x(s,n),h[0]&4&&a!==(a=u[45].type+"")&&x(c,a)},d(u){u&&y(e)}}}function ol(t){let e,l,n,s=pe(t[2].dupe),o=[];for(let i=0;i<s.length;i+=1)o[i]=il(Qt(t,s,i));return{c(){e=f("p"),e.textContent="The following cards will be considered duplicates - only one will load:",l=g(),n=f("ul");for(let i=0;i<o.length;i+=1)o[i].c();d(n,"class","svelte-zpy4zv")},m(i,a){b(i,e,a),b(i,l,a),b(i,n,a);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(n,null)},p(i,a){if(a[0]&4){s=pe(i[2].dupe);let c;for(c=0;c<s.length;c+=1){const u=Qt(i,s,c);o[c]?o[c].p(u,a):(o[c]=il(u),o[c].c(),o[c].m(n,null))}for(;c<o.length;c+=1)o[c].d(1);o.length=s.length}},d(i){i&&(y(e),y(l),y(n)),Ie(o,i)}}}function il(t){let e,l,n=t[45].title+"",s,o,i,a=t[45].type+"",c;return{c(){e=f("li"),l=f("strong"),s=Y(n),o=g(),i=f("em"),c=Y(a)},m(u,h){b(u,e,h),r(e,l),r(l,s),r(e,o),r(e,i),r(i,c)},p(u,h){h[0]&4&&n!==(n=u[45].title+"")&&x(s,n),h[0]&4&&a!==(a=u[45].type+"")&&x(c,a)},d(u){u&&y(e)}}}function $n(t){let e,l,n,s,o,i=t[2].dropped.length>0&&nl(t),a=t[2].dupe.length>0&&ol(t);return{c(){e=f("p"),e.textContent="Errors were detected in these cards that will affect import into AI Dungeon.",l=g(),i&&i.c(),n=g(),a&&a.c(),s=g(),o=f("p"),o.textContent="Cards exported this way will load as expected in this tool, but not in AI Dungeon. Really export?"},m(c,u){b(c,e,u),b(c,l,u),i&&i.m(c,u),b(c,n,u),a&&a.m(c,u),b(c,s,u),b(c,o,u)},p(c,u){c[2].dropped.length>0?i?i.p(c,u):(i=nl(c),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null),c[2].dupe.length>0?a?a.p(c,u):(a=ol(c),a.c(),a.m(s.parentNode,s)):a&&(a.d(1),a=null)},d(c){c&&(y(e),y(l),y(n),y(s),y(o)),i&&i.d(c),a&&a.d(c)}}}function rl(t){let e,l;return e=new Re({props:{title:"Import Markdown files",options:["Select Files","Cancel"],$$slots:{default:[Ln]},$$scope:{ctx:t}}}),e.$on("optionSelectFiles",t[42]),e.$on("optionCancel",t[43]),e.$on("close",t[44]),{c(){ve(e.$$.fragment)},m(n,s){be(e,n,s),l=!0},p(n,s){const o={};s[0]&1536|s[1]&524288&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){l||(P(e.$$.fragment,n),l=!0)},o(n){Z(e.$$.fragment,n),l=!1},d(n){ke(e,n)}}}function Ln(t){let e,l,n,s,o,i,a,c,u,h,p,m,w,_,v;return{c(){e=f("p"),e.innerHTML=`<a href="https://obsidian.md/" target="_blank">Obsidian</a> is a text-based note taking app with
            lots of
            features for managing relationships between documents, known as cards within the app. These cards
            are stored
            as Markdown (.md) files with a file name that reflects that card&#39;s title. We can try to load these
            cards as
            AI Dungeon story cards by mapping the file name to the card name and the file contents to the card
            entry and
            description.`,l=g(),n=f("p"),n.textContent=`Note that any Markdown/Obsidian features such as links and tags will render as plain text and will
            need to
            be edited to avoid confusing the AI.`,s=g(),o=f("p"),i=f("input"),a=g(),c=f("label"),c.textContent="Use these cards for character creation",u=g(),h=f("p"),p=f("label"),p.textContent="Imported cards will have this type:",m=g(),w=f("input"),d(i,"type","checkbox"),d(i,"name","cc"),d(i,"id","cc"),d(c,"for","cc"),d(p,"for","type"),d(w,"type","text"),d(w,"name","type"),d(w,"id","type")},m(T,E){b(T,e,E),b(T,l,E),b(T,n,E),b(T,s,E),b(T,o,E),r(o,i),i.checked=t[9],r(o,a),r(o,c),b(T,u,E),b(T,h,E),r(h,p),r(h,m),r(h,w),fe(w,t[10]),_||(v=[A(i,"change",t[40]),A(w,"input",t[41])],_=!0)},p(T,E){E[0]&512&&(i.checked=T[9]),E[0]&1024&&w.value!==T[10]&&fe(w,T[10])},d(T){T&&(y(e),y(l),y(n),y(s),y(o),y(u),y(h)),_=!1,ge(v)}}}function Dn(t){let e,l,n,s,o,i,a,c,u,h,p,m,w,_,v=t[12]?"Disable":"Enable",T,E,N,$,I,F,j,O,k,R,C,L,S,M,H,ee,ie,se,de,U,re,oe,V,K,X,z,q,ue,me,le,_e,B,G=t[6]&&el(t),te=t[7]&&tl(t),ae=t[1]&&ll(t),J=t[8]&&rl(t);return{c(){e=f("section"),l=f("button"),l.textContent="New Card",n=g(),s=f("button"),s.textContent="From File",o=g(),i=f("button"),a=Y("Save"),u=g(),h=f("button"),p=Y("Clear Cards"),w=g(),_=f("button"),T=Y(v),E=Y(" Autosave"),N=g(),$=f("section"),I=f("input"),F=g(),j=f("button"),j.textContent="Import JSON",O=g(),k=f("input"),R=g(),C=f("button"),C.textContent="Import Markdown...",L=g(),S=f("input"),M=g(),H=f("button"),H.textContent=`Open
        File`,ee=g(),ie=f("section"),se=f("button"),de=Y("Save All Cards"),re=g(),oe=f("button"),V=Y("Save Filtered Cards"),X=g(),G&&G.c(),z=g(),te&&te.c(),q=g(),ae&&ae.c(),ue=g(),J&&J.c(),me=He(),d(l,"class","svelte-zpy4zv"),d(s,"class","toggle svelte-zpy4zv"),ne(s,"open",t[5]==="from-file"),d(i,"class","toggle svelte-zpy4zv"),i.disabled=c=t[11].length===0&&t[5]!=="save",ne(i,"open",t[5]==="save"),h.disabled=m=t[11].length===0,d(h,"class","svelte-zpy4zv"),d(_,"class","svelte-zpy4zv"),d(e,"class","svelte-zpy4zv"),d(I,"id","add-file"),I.multiple=!0,d(I,"accept","application/json,text/json,.json"),d(I,"type","file"),d(I,"class","svelte-zpy4zv"),d(j,"class","svelte-zpy4zv"),d(k,"id","add-md"),k.multiple=!0,d(k,"accept","text/markdown,text/x-markdown,.md"),d(k,"type","file"),d(k,"class","svelte-zpy4zv"),d(C,"class","svelte-zpy4zv"),d(S,"id","load-file"),d(S,"accept","application/json,text/json,.json"),d(S,"type","file"),d(S,"class","svelte-zpy4zv"),d(H,"class","svelte-zpy4zv"),d($,"class","menu svelte-zpy4zv"),ne($,"open",t[5]==="from-file"),se.disabled=U=t[11].length===0,d(se,"class","svelte-zpy4zv"),oe.disabled=K=t[13].length===0,d(oe,"class","svelte-zpy4zv"),d(ie,"class","menu svelte-zpy4zv"),ne(ie,"open",t[5]==="save")},m(D,W){b(D,e,W),r(e,l),r(e,n),r(e,s),r(e,o),r(e,i),r(i,a),r(e,u),r(e,h),r(h,p),r(e,w),r(e,_),r(_,T),r(_,E),b(D,N,W),b(D,$,W),r($,I),r($,F),r($,j),r($,O),r($,k),r($,R),r($,C),r($,L),r($,S),r($,M),r($,H),b(D,ee,W),b(D,ie,W),r(ie,se),r(se,de),r(ie,re),r(ie,oe),r(oe,V),b(D,X,W),G&&G.m(D,W),b(D,z,W),te&&te.m(D,W),b(D,q,W),ae&&ae.m(D,W),b(D,ue,W),J&&J.m(D,W),b(D,me,W),le=!0,_e||(B=[A(l,"click",t[15]),A(s,"click",t[16]),A(i,"click",t[17]),A(h,"click",t[18]),A(_,"click",t[19]),A(I,"change",t[20]),A(I,"change",t[21]),A(j,"click",t[22]),A(k,"change",t[23]),A(k,"change",t[24]),A(C,"click",t[25]),A(S,"change",t[26]),A(S,"change",t[27]),A(H,"click",t[28]),A(se,"click",t[29]),A(oe,"click",t[30])],_e=!0)},p(D,W){(!le||W[0]&32)&&ne(s,"open",D[5]==="from-file"),(!le||W[0]&2080&&c!==(c=D[11].length===0&&D[5]!=="save"))&&(i.disabled=c),(!le||W[0]&32)&&ne(i,"open",D[5]==="save"),(!le||W[0]&2048&&m!==(m=D[11].length===0))&&(h.disabled=m),(!le||W[0]&4096)&&v!==(v=D[12]?"Disable":"Enable")&&x(T,v),(!le||W[0]&32)&&ne($,"open",D[5]==="from-file"),(!le||W[0]&2048&&U!==(U=D[11].length===0))&&(se.disabled=U),(!le||W[0]&8192&&K!==(K=D[13].length===0))&&(oe.disabled=K),(!le||W[0]&32)&&ne(ie,"open",D[5]==="save"),D[6]?G?(G.p(D,W),W[0]&64&&P(G,1)):(G=el(D),G.c(),P(G,1),G.m(z.parentNode,z)):G&&(Ce(),Z(G,1,1,()=>{G=null}),Te()),D[7]?te?(te.p(D,W),W[0]&128&&P(te,1)):(te=tl(D),te.c(),P(te,1),te.m(q.parentNode,q)):te&&(Ce(),Z(te,1,1,()=>{te=null}),Te()),D[1]?ae?(ae.p(D,W),W[0]&2&&P(ae,1)):(ae=ll(D),ae.c(),P(ae,1),ae.m(ue.parentNode,ue)):ae&&(Ce(),Z(ae,1,1,()=>{ae=null}),Te()),D[8]?J?(J.p(D,W),W[0]&256&&P(J,1)):(J=rl(D),J.c(),P(J,1),J.m(me.parentNode,me)):J&&(Ce(),Z(J,1,1,()=>{J=null}),Te())},i(D){le||(P(G),P(te),P(ae),P(J),le=!0)},o(D){Z(G),Z(te),Z(ae),Z(J),le=!1},d(D){D&&(y(e),y(N),y($),y(ee),y(ie),y(X),y(z),y(q),y(ue),y(me)),G&&G.d(D),te&&te.d(D),ae&&ae.d(D),J&&J.d(D),_e=!1,ge(B)}}}function Fn(t,e,l){let n,s,o;ye(t,ce,G=>l(11,n=G)),ye(t,Ye,G=>l(12,s=G)),ye(t,tt,G=>l(13,o=G));const i=new gt;let a,c,u,h=!1,p=!1,m=null,w=!1,_={dropped:[],dupe:[]},v=!1,T=!0,E="Markdown";Q.subscribe(G=>{G.types.length===1&&l(10,E=G.types[0])});const N=()=>i.addCard(),$=()=>l(5,u=u==="from-file"?void 0:"from-file"),I=()=>l(5,u=u==="save"?void 0:"save"),F=()=>l(7,p=!0),j=()=>Se(Ye,s=!s,s);function O(){c=this.files,l(4,c)}const k=()=>i.loadJson(c,ut.APPEND),R=()=>document.getElementById("add-file").click();function C(){c=this.files,l(4,c)}const L=()=>i.loadMd(c,T,E),S=()=>l(8,v=!0);function M(){a=this.files,l(3,a)}const H=()=>i.loadJson(a,ut.REPLACE),ee=()=>n.length===0?document.getElementById("load-file").click():l(6,h=!0),ie=()=>l(0,m=ft.ALL),se=()=>l(0,m=ft.FILTERED),de=()=>{l(6,h=!1),document.getElementById("load-file").click()},U=()=>l(6,h=!1),re=()=>l(6,h=!1),oe=()=>{l(7,p=!1),Se(ce,n=[],n)},V=()=>l(7,p=!1),K=()=>l(7,p=!1),X=()=>{i.download(m),l(0,m=null),l(1,w=!1)},z=()=>{l(0,m=null),l(1,w=!1)},q=()=>{l(0,m=null),l(1,w=!1)};function ue(){T=this.checked,l(9,T)}function me(){E=this.value,l(10,E)}const le=()=>{l(8,v=!1),document.getElementById("add-md").click()},_e=()=>l(8,v=!1),B=()=>l(8,v=!1);return t.$$.update=()=>{t.$$.dirty[0]&7&&m!==null&&(l(2,_=i.checkProblemCards(m)),l(1,w=_.dropped.length>0||_.dupe.length>0),w||(i.download(m),l(0,m=void 0)))},[m,w,_,a,c,u,h,p,v,T,E,n,s,o,i,N,$,I,F,j,O,k,R,C,L,S,M,H,ee,ie,se,de,U,re,oe,V,K,X,z,q,ue,me,le,_e,B]}class zn extends Pe{constructor(e){super(),Me(this,e,Fn,Dn,Oe,{},null,[-1,-1])}}function al(t,e,l){const n=t.slice();return n[6]=e[l],n}function cl(t){let e;function l(o,i){return o[1].length===0?Mn:o[2].empty||o[2].noDescription?Hn:Yn}let n=l(t),s=n(t);return{c(){s.c(),e=He()},m(o,i){s.m(o,i),b(o,e,i)},p(o,i){n!==(n=l(o))&&(s.d(1),s=n(o),s&&(s.c(),s.m(e.parentNode,e)))},d(o){o&&y(e),s.d(o)}}}function Yn(t){let e;return{c(){e=f("p"),e.textContent=`You've filtered everything out! To reset, click the "Clear Filters" button!`,d(e,"class","svelte-5fnpz7")},m(l,n){b(l,e,n)},d(l){l&&y(e)}}}function Hn(t){let e;return{c(){e=f("p"),e.textContent="No errors found! You're good!",d(e,"class","svelte-5fnpz7")},m(l,n){b(l,e,n)},d(l){l&&y(e)}}}function Mn(t){let e;return{c(){e=f("p"),e.textContent=`Load some story cards to get started! Open a scenario or adventure, go to Edit > Details > Story Card
                Management, and export your story cards! When you're done editing, you can save them here and import
                them again in the same section.
            `,d(e,"class","svelte-5fnpz7")},m(l,n){b(l,e,n)},d(l){l&&y(e)}}}function ul(t){let e,l;function n(){return t[5](t[6])}return e=new wl({props:{card:t[6]}}),e.$on("reorder",t[3]),e.$on("update",t[4]),e.$on("delete",n),{c(){ve(e.$$.fragment)},m(s,o){be(e,s,o),l=!0},p(s,o){t=s;const i={};o&1&&(i.card=t[6]),e.$set(i)},i(s){l||(P(e.$$.fragment,s),l=!0)},o(s){Z(e.$$.fragment,s),l=!1},d(s){ke(e,s)}}}function Pn(t){let e,l,n,s,o,i,a,c,u,h,p,m,w=t[0].length+"",_,v,T=t[1].length+"",E,N,$;s=new gn({}),i=new zn({}),c=new An({});let I=pe(t[0]),F=[];for(let k=0;k<I.length;k+=1)F[k]=ul(al(t,I,k));const j=k=>Z(F[k],1,1,()=>{F[k]=null});let O=null;return I.length||(O=cl(t)),{c(){e=f("header"),l=f("h2"),l.textContent="Story Card Viewer/Editor",n=g(),ve(s.$$.fragment),o=g(),ve(i.$$.fragment),a=g(),ve(c.$$.fragment),u=g(),h=f("main"),p=f("em"),m=Y("Showing "),_=Y(w),v=Y(" entries out of "),E=Y(T),N=g();for(let k=0;k<F.length;k+=1)F[k].c();O&&O.c(),d(l,"class","svelte-5fnpz7"),d(e,"class","svelte-5fnpz7"),d(h,"class","svelte-5fnpz7")},m(k,R){b(k,e,R),r(e,l),r(e,n),be(s,e,null),r(e,o),be(i,e,null),b(k,a,R),be(c,k,R),b(k,u,R),b(k,h,R),r(h,p),r(p,m),r(p,_),r(p,v),r(p,E),r(h,N);for(let C=0;C<F.length;C+=1)F[C]&&F[C].m(h,null);O&&O.m(h,null),$=!0},p(k,[R]){if((!$||R&1)&&w!==(w=k[0].length+"")&&x(_,w),(!$||R&2)&&T!==(T=k[1].length+"")&&x(E,T),R&7){I=pe(k[0]);let C;for(C=0;C<I.length;C+=1){const L=al(k,I,C);F[C]?(F[C].p(L,R),P(F[C],1)):(F[C]=ul(L),F[C].c(),P(F[C],1),F[C].m(h,null))}for(Ce(),C=I.length;C<F.length;C+=1)j(C);Te(),!I.length&&O?O.p(k,R):I.length?O&&(O.d(1),O=null):(O=cl(k),O.c(),O.m(h,null))}},i(k){if(!$){P(s.$$.fragment,k),P(i.$$.fragment,k),P(c.$$.fragment,k);for(let R=0;R<I.length;R+=1)P(F[R]);$=!0}},o(k){Z(s.$$.fragment,k),Z(i.$$.fragment,k),Z(c.$$.fragment,k),F=F.filter(Boolean);for(let R=0;R<F.length;R+=1)Z(F[R]);$=!1},d(k){k&&(y(e),y(a),y(u),y(h)),ke(s),ke(i),ke(c,k),Ie(F,k),O&&O.d()}}}function jn(t,e,l){let n,s,o;return ye(t,tt,u=>l(0,n=u)),ye(t,ce,u=>l(1,s=u)),ye(t,Q,u=>l(2,o=u)),[n,s,o,u=>ce.update(h=>{const p=h[u.detail.old];return h.splice(u.detail.old,1),h.splice(u.detail.current,0,p),h}),()=>ce.update(u=>u),u=>ce.update(h=>h.filter(p=>p!==u))]}class Jn extends Pe{constructor(e){super(),Me(this,e,jn,Pn,Oe,{})}}new Jn({target:document.getElementById("app")});
